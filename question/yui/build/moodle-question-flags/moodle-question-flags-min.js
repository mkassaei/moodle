YUI.add("moodle-question-flags",function(e,t){M.question=M.question||{},M.question.flags={flagattributes:[],actionurl:null,flagtext:[],listeners:[],init:function(t,n,r){M.question.flags.flagattributes=n,M.question.flags.actionurl=t,M.question.flags.flagtext=r,e.all("div.questionflag").each(function(t){var n=t.one("input[type=checkbox]");if(!n)return;var r=e.Node.create('<input type="hidden" class="questionflagvalue" />');r.set("id",n.get("id")),r.set("name",n.get("name")),r.set("value",n.get("checked")?1:0);var i=e.Node.create('<input type="image" class="questionflagimage" />'),s=e.Node.create('<span class="questionflagtext">.</span>');M.question.flags.update_flag(r,i,s),n.remove(),t.one("label").remove(),t.append(r),t.append(i),t.append(s)}),e.delegate("click",function(t){var n=this.one("input.questionflagvalue");n.set("value",1-n.get("value")),M.question.flags.update_flag(n,this.one("input.questionflagimage"),this.one("span.questionflagtext"));var r=this.one("input.questionflagpostdata").get("value")+n.get("value");t.halt(),e.io(M.question.flags.actionurl,{method:"POST",data:r}),M.question.flags.fire_listeners(r)},document.body,"div.questionflag")},update_flag:function(e,t,n){var r=e.get("value");t.setAttrs(M.question.flags.flagattributes[r]),n.replaceChild(n.create(M.question.flags.flagtext[r]),n.get("firstChild")),n.set("title",M.question.flags.flagattributes[r].title)},add_listener:function(e){M.question.flags.listeners.push(e)},fire_listeners:function(e){for(var t=0;t<M.question.flags.listeners.length;t++)M.question.flags.listeners[t](e.match(/\bqubaid=(\d+)\b/)[1],e.match(/\bslot=(\d+)\b/)[1],e.match(/\bnewstate=(\d+)\b/)[1])}}},"@VERSION@",{requires:["base","dom","event-delegate","io-form"]});
